# Hypercalc

A multi-dimensional, headless JavaScript spreadsheet for the browser or Node.js.

1. Small: 26K Raw ES6, 14K Compressed ES6, 3.7K gzipped ES6
2. One dependency, mathjs which if browserified, transpiled, compressed, gzipped together results in 133K ... which is mostly mathjs.
3. Multi-dimensional ranges can be flattened for operations like sum and product or left as arrays to support matrix operations.
4. Single, two, three, and n-dimensional ranges can be created and updated through the use of wildcard matching. No need to modify formulas every time a new sheet is addded.

# Why Hypercalc

1. Computing using a spreasheet approach is often more convenient than using a database.
2. We got tired of building complex spreasheets that were rigid and fragile with respect to cross sheet or matrix calculations.
3. We had many situations in which we did not need the front end of a spreadsheet.

# Use

## Installation

npm install hypercalc

or

grab the browser code from [Github](https://github.com/anywhichway/hypercalc/tree/master/browser)


## Formulas

Hypercalc formulas look similar to those in MS Excel or Google sheets. They start with `=` followed by a function name and arguments in parentheses.

Hypercalc range specifications are always wrapped in a value selection call as `$(range string)`. The range string must be quoted and all portions are `.` delimited. The MS Excel range `Sheet1!A1` would be `Sheet1.A.1` in Hypercalc.

Range strings support:

1) wild card matching, e.g. `*.A.1` matches column A of row 1 on all sheets.
2) literal or conditions, e.g. `Sheet1|Sheet3.A.1` matches column A of row 1 on sheets 1 and 3.
3) range matching, e.g. `Sheet1|Sheet3.A:D.1` matches columns A through D of row 1 on sheets 1 and 3.

The value selection function, `$`, returns an array. This can be destructured to pass the results to functions taking multiple arguments, e.g. `=sum(...$('*.A.1')`. However, most multiple argument functions will also accept an array as the first argument, e.g. `=sum($('*.A.1'))`. This is important for large ranges since exploding the selection will push each element onto the stack which may cause an out of memory error.

There is much more to say, but Hypercalc is in ALPHA, so be patient.


# Functions

The below list covers approximately 70% of Hypercalc functionality.

Currently the documentation is generated by the unit test code and clustered based on convenience for automated test generation. Over time it will get reworked and clustered by type, e.g. statistical vs arithmetic functions, etc.

We have a lot to document .... bear with us.

<table>

  <tr><th colspan='3' align='left'>Unary Numeric Functions</th></tr><tr><th align='left'>Name</th><th align='left'>Example</th><th align='left'>Result</th></tr>
    <tr><td>abs</td><td>=abs(3.5)</td><td>3.5</td></tr>
    <tr><td>acos</td><td>=acos(3.5)</td><td>1.9248473002384139i</td></tr>
    <tr><td>acosh</td><td>=acosh(3.5)</td><td>1.9248473002384139</td></tr>
    <tr><td>acot</td><td>=acot(3.5)</td><td>0.27829965900511133</td></tr>
    <tr><td>acoth</td><td>=acoth(3.5)</td><td>0.29389333245105953</td></tr>
    <tr><td>acsc</td><td>=acsc(3.5)</td><td>0.28975170143604745</td></tr>
    <tr><td>acsch</td><td>=acsch(3.5)</td><td>0.28196323918998284</td></tr>
    <tr><td>asec</td><td>=asec(3.5)</td><td>1.2810446253588492</td></tr>
    <tr><td>asech</td><td>=asech(3.5)</td><td>1.1102230246251564e-16 - 1.2810446253588492i</td></tr>
    <tr><td>asin</td><td>=asin(3.5)</td><td>1.5707963267948966 - 1.9248473002384139i</td></tr>
    <tr><td>asinh</td><td>=asinh(3.5)</td><td>1.9657204716496515</td></tr>
    <tr><td>atan</td><td>=atan(3.5)</td><td>1.2924966677897853</td></tr>
    <tr><td>atanh</td><td>=atanh(3.5)</td><td>0.29389333245105953 - 1.5707963267948966i</td></tr>
    <tr><td>ceil</td><td>=ceil(3.5)</td><td>4</td></tr>
    <tr><td>cos</td><td>=cos(3.5)</td><td>-0.9364566872907963</td></tr>
    <tr><td>cosh</td><td>=cosh(3.5)</td><td>16.572824671057315</td></tr>
    <tr><td>cot</td><td>=cot(3.5)</td><td>2.669616484968866</td></tr>
    <tr><td>coth</td><td>=coth(3.5)</td><td>1.0018254285064434</td></tr>
    <tr><td>csc</td><td>=csc(3.5)</td><td>-2.850763437540464</td></tr>
    <tr><td>csch</td><td>=csch(3.5)</td><td>0.06044989000915611</td></tr>
    <tr><td>cube</td><td>=cube(3.5)</td><td>42.875</td></tr>
    <tr><td>factorial</td><td>=factorial(3.5)</td><td>11.631728396567446</td></tr>
    <tr><td>floor</td><td>=floor(3.5)</td><td>3</td></tr>
    <tr><td>gamma</td><td>=gamma(3.5)</td><td>3.3233509704478403</td></tr>
    <tr><td>isInteger</td><td>=isInteger(3.5)</td><td>false</td></tr>
    <tr><td>isNegative</td><td>=isNegative(3.5)</td><td>false</td></tr>
    <tr><td>isNumeric</td><td>=isNumeric(3.5)</td><td>true</td></tr>
    <tr><td>isPositive</td><td>=isPositive(3.5)</td><td>true</td></tr>
    <tr><td>isPrime</td><td>=isPrime(3.5)</td><td>true</td></tr>
    <tr><td>isZero</td><td>=isZero(3.5)</td><td>false</td></tr>
    <tr><td>isNaN</td><td>=isNaN(3.5)</td><td>false</td></tr>
    <tr><td>log10</td><td>=log10(3.5)</td><td>0.5440680443502757</td></tr>
    <tr><td>sec</td><td>=sec(3.5)</td><td>-1.0678550471918107</td></tr>
    <tr><td>sech</td><td>=sech(3.5)</td><td>0.06033974412016765</td></tr>
    <tr><td>sin</td><td>=sin(3.5)</td><td>-0.35078322768961984</td></tr>
    <tr><td>sinh</td><td>=sinh(3.5)</td><td>16.542627287634996</td></tr>
    <tr><td>sqrt</td><td>=sqrt(3.5)</td><td>1.8708286933869707</td></tr>
    <tr><td>square</td><td>=square(3.5)</td><td>12.25</td></tr>
    <tr><td>tan</td><td>=tan(3.5)</td><td>0.3745856401585947</td></tr>
    <tr><td>tanh</td><td>=tanh(3.5)</td><td>0.9981778976111987</td></tr>

  <tr><th colspan='3' align='left'>Multi Argument Numeric Functions</th></tr><tr><th align='left'>Name</th><th align='left'>Example</th><th align='left'>Result</th></tr>
    <tr><td>average</td><td>=average(0,1,2,3,3,4,5,6)</td><td>3</td></tr>
    <tr><td>max</td><td>=max(0,1,2,3,3,4,5,6)</td><td>6</td></tr>
    <tr><td>median</td><td>=median(0,1,2,3,3,4,5,6)</td><td>3</td></tr>
    <tr><td>min</td><td>=min(0,1,2,3,3,4,5,6)</td><td>0</td></tr>
    <tr><td>mode</td><td>=mode(0,1,2,3,3,4,5,6)</td><td>[3]</td></tr>
    <tr><td>product</td><td>=product(0,1,2,3,3,4,5,6)</td><td>0</td></tr>
    <tr><td>stdev</td><td>=stdev(0,1,2,3,3,4,5,6)</td><td>2</td></tr>
    <tr><td>sum</td><td>=sum(0,1,2,3,3,4,5,6)</td><td>24</td></tr>

  <tr><th colspan='3' align='left'>Array Functions</th></tr><tr><th align='left'>Name</th><th align='left'>Example</th><th align='left'>Result</th></tr>
    <tr><td>average</td><td>=average([1,2,3,3,4,5,6])</td><td>3.4285714285714284</td></tr>
    <tr><td>difference</td><td>=difference([1,2,3,3,4,5,6])</td><td>-22</td></tr>
    <tr><td>max</td><td>=max([1,2,3,3,4,5,6])</td><td>6</td></tr>
    <tr><td>median</td><td>=median([1,2,3,3,4,5,6])</td><td>3</td></tr>
    <tr><td>min</td><td>=min([1,2,3,3,4,5,6])</td><td>1</td></tr>
    <tr><td>mode</td><td>=mode([1,2,3,3,4,5,6])</td><td>[3]</td></tr>
    <tr><td>product</td><td>=product([1,2,3,3,4,5,6])</td><td>2160</td></tr>
    <tr><td>stdev</td><td>=stdev([1,2,3,3,4,5,6])</td><td>1.7182493859684491</td></tr>
    <tr><td>sum</td><td>=sum([1,2,3,3,4,5,6])</td><td>24</td></tr>

  <tr><th colspan='3' align='left'>Matrix Functions</th></tr><tr><th align='left'>Name</th><th align='left'>Example</th><th align='left'>Result</th></tr>
      <tr><td>difference</td><td>=difference([1,2,3],1)</td><td>[0,1,2]</td></tr>
      <tr><td>difference</td><td>=difference([1,2,3],[1,2,3])</td><td>[0,0,0]</td></tr>
      <tr><td>difference</td><td>=difference([1,2,3],[1,2,3],1)</td><td>[-1,-1,-1]</td></tr>
      <tr><td>product</td><td>=product([1,2,3],1)</td><td>[1,2,3]</td></tr>
      <tr><td>product</td><td>=product([[1,2,3], [1,2,3]],[[1,2], [1,2],[1,2]])</td><td>[[6,12],[6,12]]</td></tr>
      <tr><td>product</td><td>=product([1,2,3],[1,2,3],1)</td><td>[1,4,9]</td></tr>
      <tr><td>dotProduct</td><td>=dotProduct([1,2,3],1)</td><td>[1,2,3]</td></tr>
      <tr><td>dotProduct</td><td>=dotProduct([1,2,3], [1,2,3])</td><td>[1,4,9]</td></tr>
      <tr><td>dotProduct</td><td>=dotProduct([1,2,3], [1,2,3],2)</td><td>[2,8,18]</td></tr>
      <tr><td>quotient</td><td>=quotient([1,2,3],1)</td><td>[1,2,3]</td></tr>
      <tr><td>quotient</td><td>=quotient([[1,2,3], [1,2,3], [1,2,3]],[[1,2,3], [1,2,3],[1,2,3]])</td><td>[[1,1,1],[1,1,1],[1,1,1]]</td></tr>
      <tr><td>quotient</td><td>=quotient([1,2,3],[1,2,3],1)</td><td>[1,4,9]</td></tr>
      <tr><td>dotQuotient</td><td>=dotQuotient([1,2,3],1)</td><td>[1,2,3]</td></tr>
      <tr><td>dotQuotient</td><td>=dotQuotient([1,2,3], [1,2,3])</td><td>[1,1,1]</td></tr>
      <tr><td>dotQuotient</td><td>=dotQuotient([1,2,3], [1,2,3],2)</td><td>[0.5,0.5,0.5]</td></tr>
      <tr><td>sum</td><td>=sum([1,2,3],1)</td><td>[2,3,4]</td></tr>
      <tr><td>sum</td><td>=sum([1,2,3],[1,2,3])</td><td>[2,4,6]</td></tr>
      <tr><td>sum</td><td>=sum([1,2,3],[1,2,3],1)</td><td>[3,5,7]</td></tr>
  <tr><th colspan='3' align='left'>Constants</th></tr><tr><th align='left'>Name</th><th align='left'>Example</th><th align='left'>Result</th></tr>
    <tr><td>e</td><td>=e()</td><td>2.718281828459045</td></tr>
    <tr><td>i</td><td>=i()</td><td>i</td></tr>
    <tr><td>pi</td><td>=pi()</td><td>3.141592653589793</td></tr>
    <tr><td>ln2</td><td>=ln2()</td><td>0.6931471805599453</td></tr>
    <tr><td>ln10</td><td>=ln10()</td><td>2.302585092994046</td></tr>
    <tr><td>log2e</td><td>=log2e()</td><td>1.4426950408889634</td></tr>
    <tr><td>log10e</td><td>=log10e()</td><td>0.4342944819032518</td></tr>
    <tr><td>phi</td><td>=phi()</td><td>1.618033988749895</td></tr>
    <tr><td>tau</td><td>=tau()</td><td>6.283185307179586</td></tr>
    
</table>

# Release History (reverse chronological order)

2017-05-06 v0.0.5 ALPHA More unit tests and documentation.

2017-05-05 v0.0.4 ALPHA More unit tests and documentation.

2017-05-04 v0.0.3 ALPHA Started adding unit tests and documentation.

2017-05-03 v0.0.2 ALPHA Cleaned-up directory structure, browserified.

2017-05-03 v0.0.1 ALPHA Initial public release.

# License

Dual: AGPLv3 or Commercial
